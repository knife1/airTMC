;(function($){var _MVC_CallBackARR={};var CALLBACKLIST=[];$.extend({pagination:function(option,pageIndex,history){var config={url:"",pageSize:20,templateId:"",updateId:"",data:null,callBack:null,pagerId:"pagerJSRender",isHistory:true,pagerSuccess:null,beforeSend:null,pagerError:null,choseSelect:false,selectNum:["20","50","100"]},callType="callBack";$.extend(config,option);if(config.choseSelect){config.pageSize=$("#"+config.pagerId).find("select").val()||config.pageSize}if(pageIndex===undefined||pageIndex===""||parseInt(pageIndex)<=0){pageIndex=1}if(typeof pageIndex==="string"){pageIndex=parseInt(pageIndex,10)}if(!(typeof config.data==="object")){return}if(config.templateId===""){return}if(config.updateId===""){return}$.each(config,function(key,value){if(typeof value==="function"){CALLBACKLIST.push(key)}});$.ajax({url:config.url+"?pageIndex="+pageIndex+"&pageSize="+config.pageSize,data:config.data,type:!config.type?"get":config.type,cache:false,beforeSend:function(){callType="beforeSend";if(typeof config.beforeSend==="function"){config.beforeSend();_MVC_CallBackARR[callType+config.pagerId]=config.beforeSend}else if(typeof _MVC_CallBackARR[callType+config.pagerId]==="function"){_MVC_CallBackARR[callType+config.pagerId]()}},success:function(result){if(history!==1&&config.isHistory){var state={};state.pageIndex=pageIndex;state.options={};$.extend(state.options,config);$.each(CALLBACKLIST,function(){var key=this.valueOf(),value=config[key]||_MVC_CallBackARR[key+config.pagerId];if(value!==null&&value!==undefined){state.options[key]=value.toString()}});History.pushState(state,document.title,location.href.split("#")[0]+"#pageIndex="+pageIndex);var insertCookie=function(cookieName,cookieValue){var cookieLen=cookieValue.length;if(cookieLen>2000){for(var i=0,len=Math.ceil(cookieLen/2000);i<len;i++){if(i===0){$.cookie(cookieName+i,cookieValue.substr(i*2000,2000))}else{$.cookie(cookieName+i,cookieValue.substr(i*2000+1,2000))}}}else{$.cookie(cookieName+"0",cookieValue)}};if(!ISSUPPORT&&!$.cookie("HISTORY_STATE_OPTION")){var cookieOptions=$.extend({},state.options);$.each(CALLBACKLIST,function(){var key=this.valueOf();if(cookieOptions[key]!==null){var cookieName="HISTORY_STATE_OPTION_"+key.toUpperCase(),callBackValue=cookieOptions[key].replace(/\;/g,"_HISTORY_SEMICOLON_").replace(/\+/g,"_HISTORY_ADD_").replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"").replace(/\\r\\n/g,'').replace(/\\t/g,"");insertCookie(cookieName,callBackValue);cookieOptions[key+"CookieName"]=cookieName;cookieOptions[key+"SubCount"]=Math.ceil(callBackValue.length/2000)}delete cookieOptions[key]});$.cookie("HISTORY_STATE_OPTION",decodeURIComponent(JSON.stringify(state.options).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"")))}}var resData=null,pageTotalCount=0,pageCount=1,HasPreviousPage=false,HasNextPage=false,choseSelect=false,selectNum=[];if(!result){return}try{resData=JSON.parse(result.replace(/\r/g,"").replace(/\n/g,""))}catch(ex){try{resData=eval("("+result.replace(/\r/g,"").replace(/\n/g,"")+")")}catch(ex){callType="pagerError";if(typeof config.pagerError==="function"){config.pagerError(ex);_MVC_CallBackARR[callType+config.pagerId]=config.pagerError}else if(typeof _MVC_CallBackARR[callType+config.pagerId]==="function"){_MVC_CallBackARR[callType+config.pagerId](ex)}else{}return}}callType="callBack";if(typeof config.callBack==="function"){resData=config.callBack(resData);_MVC_CallBackARR[callType+config.pagerId]=config.callBack}else if(typeof _MVC_CallBackARR[callType+config.pagerId]==="function"){resData=_MVC_CallBackARR[callType+config.pagerId](resData)}try{pageTotalCount=parseInt(resData.totalCount,10)}catch(ex){try{pageTotalCount=parseInt(resData[0].totalCount,10)}catch(ex){callType="pagerError";if(typeof config.pagerError==="function"){config.pagerError(ex);_MVC_CallBackARR[callType+config.pagerId]=config.pagerError}else if(typeof _MVC_CallBackARR[callType+config.pagerId]==="function"){_MVC_CallBackARR[callType+config.pagerId](ex)}else{}return}}pageCount=Math.ceil(pageTotalCount/config.pageSize);if(pageCount<=0){$("#"+config.updateId+"").html("");$("#"+config.pagerId).html("");$("."+config.pagerId).html("")}pageIndex=pageIndex>pageCount?pageCount:pageIndex;if(!(pageIndex==1)){HasPreviousPage=true}if(!(pageIndex===pageCount)){HasNextPage=true}var commonBackData=JSON.stringify(config),protocol=('https:'==document.location.protocol?'https://':'http://');var tempData={data:commonBackData,PageSize:config.pageSize,HasPreviousPage:HasPreviousPage,HasNextPage:HasNextPage,CurrentPage:pageIndex>pageCount?pageCount:pageIndex,PageCount:pageCount,PageTotalCount:pageTotalCount,choseSelect:config.choseSelect,selectNum:config.selectNum};$("#"+config.updateId).html($("#"+config.templateId).render(resData));$.templates("pager","<div>每页{{if !choseSelect}}{{:PageSize}}{{else}}<select  autocomplete='off' onchange='$.pagination({{:data}},1);return false;'>{{for selectNum}}<option  value='{{> #data}}' {{if #data== ~root.PageSize }}selected {{/if}}> {{> #data}}</option>{{/for}}</select>{{/if}}条&nbsp;&nbsp;共{{:PageTotalCount}}条&nbsp;&nbsp;{{if HasPreviousPage}}<a href='javascript:;' onclick='$.pagination({{:data}},1);return false;'>首页</a>&nbsp;&nbsp;<a href='javascript:;' onclick='$.pagination({{:data}},{{:CurrentPage - 1}});return false;'>上一页</a>&nbsp;&nbsp;{{else}}<a style='color:#808080; text-decoration:none' disabled='disabled'>首页</a>&nbsp;&nbsp;<a style='color:#808080; text-decoration:none' disabled='disabled'>上一页</a>&nbsp;&nbsp;{{/if}}&nbsp;{{if HasNextPage}}<a href='javascript:;' onclick='$.pagination({{:data}},{{:CurrentPage + 1}});return false;'>下一页</a>&nbsp;&nbsp;<a href='javascript:;' onclick='$.pagination({{:data}},{{:PageCount}});return false;'>尾页</a>&nbsp;&nbsp;{{else}}<a style='color:#808080; text-decoration:none' disabled='disabled'>下一页</a>&nbsp;&nbsp;<a style='color:#808080; text-decoration:none' disabled='disabled'>尾页</a>&nbsp;&nbsp;{{/if}}{{:CurrentPage}}/{{:PageCount}}&nbsp;&nbsp;<span class='form-inline'> 转到：<input type='text' class='form-control input-small w50' id='_MvcPager_Ctrl0_pib' value='{{:CurrentPage}}' onkeyup = \"value=value.replace(/[^(0-9)]/g,'');\" />&nbsp;&nbsp;<button class='btn btn-default btn-small' onclick='$.pagination({{:data}},$.trim($(this).prev(\"input\").val()));return false;'>确定</button></span></div>");if(pageCount>0){$("#"+config.pagerId).html($.render.pager(tempData));$("."+config.pagerId).html($.render.pager(tempData))}callType="pagerSuccess";if(typeof config.pagerSuccess==="function"){config.pagerSuccess();_MVC_CallBackARR[callType+config.pagerId]=config.pagerSuccess}else if(typeof _MVC_CallBackARR[callType+config.pagerId]==="function"){_MVC_CallBackARR[callType+config.pagerId]()}},error:function(ex){callType="pagerError";if(typeof config.pagerError==="function"){config.pagerError(ex);_MVC_CallBackARR[callType+config.pagerId]=config.pagerError}else if(typeof _MVC_CallBackARR[callType+config.pagerId]==="function"){_MVC_CallBackARR[callType+config.pagerId](ex)}else{}}})}})})(jQuery);(function(window,document){window.ISSUPPORT=!!(window.history&&history.pushState);window.IS_FIRST_LOAD=true;var count=0,preventDefault=0;window.History={state:{},pushState:null,replaceState:null,popState:null};var callBack=function(){if(!preventDefault){if(typeof History.popState=="function"){History.popState()}}else{preventDefault=0}};if(ISSUPPORT){History.pushState=function(state,title,url){window.history.pushState(state,title,url)};History.replaceState=function(state,title,url){window.history.replaceState(state,title,url)};if(window.addEventListener){window.addEventListener('popstate',callBack,false)}else{window.attachEvent('onpopstate',callBack)}}else{var Browser=(Browser=/msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase()))?{type:"ie",version:Browser[1]}:null;var hashChange=!!('onhashchange'in window)&&!(Browser.type=="ie"&&(Browser.version<8||document.documentMode<8));var Hash={set:function(hash){window.location.hash=hash},get:function(){return window.location.hash}};History.pushState=function(state,title,url){History.state['"'+count++ +'"']=state;document.title=title;if(hashChange){preventDefault=1;Hash.set(url.split('#')[1])}};if(hashChange){if(window.addEventListener){window.addEventListener('hashchange',callBack,false)}else{window.attachEvent('onhashchange',callBack)}}}var stateOpration={getCookieValue:function(cookieName,cookieCount){var cookieStr="";if(cookieCount>0){for(var i=0;i<cookieCount;i++){cookieStr+=$.cookie(cookieName+i).replace(/_HISTORY_SEMICOLON_/g,"\;").replace(/_HISTORY_ADD_/g,"\+")}}else{cookieStr=$.cookie(cookieName+"0").replace(/_HISTORY_SEMICOLON_/g,"\;").replace(/_HISTORY_ADD_/g,"\+")}return cookieStr},returnFunction:function(options){var callBackList=['callBack','pagerSuccess','beforeSend','pagerError'];$.each(callBackList,function(){var callBackName=this.valueOf();if(options[callBackName]){options[callBackName]=(new Function("return "+options[callBackName]))()}})},pagination:function(state){stateOpration.returnFunction(state.options);$.pagination(state.options,state.pageIndex,1)},isEmptyObject:function(obj){for(var key in obj){return false}return true}};History.popState=function(){if(ISSUPPORT){if(history.state){stateOpration.pagination(history.state);if(IS_FIRST_LOAD){IS_FIRST_LOAD=false}}else{if(!IS_FIRST_LOAD){location.reload()}else{IS_FIRST_LOAD=false}}}else{if(!stateOpration.isEmptyObject(History.state)){if(location.hash){var count=-1;for(var i in History.state){count+=1}if(count){stateOpration.pagination(History.state['"'+ --count+'"']);delete History.state['"'+count+'"']}}else{location.reload()}}else if($.cookie("HISTORY_STATE_OPTION")){if(location.hash){var pageIndex=location.hash.substring(11),options=JSON.parse(decodeURIComponent($.cookie("HISTORY_STATE_OPTION")));$.each(options,function(key,value){var subCountIndex=key.indexOf("SubCount");if(subCountIndex!==-1&&value!==null){var name=key.substr(0,subCountIndex);options[name]=stateOpration.getCookieValue(options[name+"CookieName"],value)}});stateOpration.returnFunction(options);$.pagination(options,pageIndex,1)}else{location.reload()}}}};$(document).ready(function(){if(ISSUPPORT){if(history.state){stateOpration.pagination(history.state)}}else if($.cookie("HISTORY_STATE_OPTION")){if(location.hash){var pageIndex=location.hash.substring(11),options=JSON.parse(decodeURIComponent($.cookie("HISTORY_STATE_OPTION")));$.each(options,function(key,value){var subCountIndex=key.indexOf("SubCount");if(subCountIndex!==-1&&value!==null){var name=key.substr(0,subCountIndex);options[name]=stateOpration.getCookieValue(options[name+"CookieName"],value)}});stateOpration.returnFunction(options);$.pagination(options,pageIndex,1)}}})})(window,document);